 <!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <title>Denoでチャットアプリ</title>
  </head>
  <body>
    <div>
      <input type="text" id="input" />
      <button id="sendButton" disabled>送信</button>
      <button id="enterButton" disabled>入室</button>
      <button id="leaveButton" disabled>退室</button>
    </div>
    <ul id="timeline"></ul>
    <script>
      let ws;
      let isConnected = false;
      const input = document.getElementById("input");
      const sendButton = document.getElementById("sendButton");
      const enterButton = document.getElementById("enterButton");
      const leaveButton =document.getElementById("leaveButton");
      const timeline = document.getElementById("timeline");
      input.addEventListener("keydown", sendMessageByEnterKey);
      sendButton.onclick = sendMessage;
      enterButton.onclick = connectWebSocket;
      leaveButton.onclick = leaveRoom;
      applyButtonState();
      connectWebSocket();
      function connectWebSocket() {
        if (ws) ws.close();
        ws = new WebSocket(`ws://${location.host}/ws`);
        ws.addEventListener("open", () => {
          isConnected = true;
          applyButtonState();
        });
        ws.addEventListener("message", ({data}) => {
          timeline.appendChild(messageDom(data));
        });
        ws.addEventListener("close", () => {
          isConnected = false;
          applyButtonState();
        });
      }
      function sendMessageByEnterKey(e) {
        if (e.keyCode === 13) sendMessage();
      }
      function sendMessage() {
        const msg = input.value;
        ws.send(msg);
        input.value = "";
      }
      function messageDom(msg) {
        const li = document.createElement("li");
        li.className = "message";
        li.innerText = msg;
        return li;
      }
      function leaveRoom() {
        ws.close();
        isConnected = false;
        applyButtonState();
      }
      function applyButtonState() {
        sendButton.disabled = isConnected ? false : true;
        enterButton.disabled = isConnected ? true : false;
        leaveButton.disabled = isConnected ? false : true;
      }
    </script>
  </body>
</html> 






<!--
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="top-PAGE" content="gannbaru">
  <title>トップページ</title>
   <!-- CSS -->
   <link rel="stylesheet" 
    href="https://unpkg.com/ress/dist/ress.min.css">
   <link rel="stylesheet" 
    href="style.css">
   <link rel="stylesheet" type="text/css" 
    href="https://coco-factory.jp/ugokuweb/wp-content/themes/ugokuweb/data/reset.css">
   <link rel="stylesheet" type="text/css" 
    href="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.css">
   <link rel="stylesheet" type="text/css" 
    href="https://coco-factory.jp/ugokuweb/wp-content/themes/ugokuweb/data/6-1-6/css/6-1-6.css">
</head>
<header class=page-header　wrapper>
  <h1><a href=index.html>タイトル</a></h1>
  
  </header>
<body>
<!--上にスクロールするとカメラ-->

  <!--urlは画像の人のに-->
  <h2><a href=profile.html>ユーザプロフィール(名前)</a></h2>
  <!--スクロールしてるとこ。画像と文字はプレスホルダーなので、後に変更できるようにする
  　クリックするとファボれたりプロフィールに飛べるようにもする
    それと、なんかバグるから画像の保存を750*500にしたい-->
  <div class="slider">
    <li><img src="https://coco-factory.jp/ugokuweb/wp-content/themes/ugokuweb/data/6-1-6/img/img_01.jpg" alt="">
      <p class="sc_chr">コレはテストです１<p></li>
    <li><img src="https://coco-factory.jp/ugokuweb/wp-content/themes/ugokuweb/data/6-1-6/img/img_02.jpg" alt="">
      <p class="sc_chr">コレはテストです２<p></li>
    <li><img src="https://coco-factory.jp/ugokuweb/wp-content/themes/ugokuweb/data/6-1-6/img/img_03.jpg" alt="">
      <p class="sc_chr">コレはテストです３<p></li>
    <li><img src="https://coco-factory.jp/ugokuweb/wp-content/themes/ugokuweb/data/6-1-6/img/img_04.jpg" alt="">
      <p class="sc_chr">コレはテストです４<p></li>
    <li><img src="https://coco-factory.jp/ugokuweb/wp-content/themes/ugokuweb/data/6-1-6/img/img_05.jpg" alt="">
      <p class="sc_chr">コレはテストです５<p></li>
    <li><img src="https://coco-factory.jp/ugokuweb/wp-content/themes/ugokuweb/data/6-1-6/img/img_06.jpg" alt="">
      <p class="sc_chr">コレはテストです６<p></li>
    <li><img src="road.png" alt=""></li><!--全然つづりが違う-->
      </div>
      <p class="slick-num">
        <span class="inner">
            <span class="nowcnt"></span> ／ <span class="allcnt"></span>
        </span>
      </p>
  <!--ライセンス関係なので消してはいけない-->
  <p>使用したライブラリ：<a href="https://kenwheeler.github.io/slick/" 
    target="_blank">https://kenwheeler.github.io/slick/</a></p>

    <!--以下JS-->
    <script type=module>

    //スライドの設定
    $('.slider').on('init reInit afterChange', function (event, slick, currentSlide, nextSlide) {
	    var i = (currentSlide ? currentSlide : 0) + 1;
	    $('.slick-num .nowcnt').text(i);
	    $('.slick-num .allcnt').text(slick.slideCount);
      if(i==slick.slideCount){
        ////////////////////////////////////
        //更新の処理を書く場所//歩数も減らす
        /////////////////////////////////
        window.location.href = 'index.html'; 
      }
    });
    $('.slider').slick({
    autoplay: false,//自動的に動き出すか。
    infinite: false,//スライドをループさせるかどうか。
    slidesToShow: 1.1,//スライドを画面に見せる枚数
    slidesToScroll: 1,//移動量
    prevArrow: '<div class="slick-prev"></div>',//矢印部分PreviewのHTMLを変更
    nextArrow: '<div class="slick-next"></div>',//矢印部分NextのHTMLを変更
    dots: true,//下部ドットナビゲーションの表示
    /*
    responsive: [
      {
      breakpoint: 769,//モニターの横幅
      settings: {
        slidesToShow: 1,//スライドを画面に見せる枚数
        slidesToScroll: 1,//移動量
      }
    },
    {
      breakpoint: 426,//モニターの横幅
      settings: {
        slidesToShow: 1,//スライドを画面に見せる枚数
        slidesToScroll: 1,//移動量
      }
    }
  ]*/
  });
    </script>
    <!--jquery-->
    <script type="text/javascript" 
     src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <!--slick-->
    <script type="text/javascript" 
     src="//cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js"></script>

     <h1><a href=test.html>テスト用</a></h1>
</body>
</html>-->